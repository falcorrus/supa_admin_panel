# Инструкция по подключению клиента к Supabase

## Создание необходимой RPC функции

Для корректной работы административной панели необходимо создать специальную RPC функцию в вашей базе данных Supabase, которая будет использоваться для получения списка таблиц.

### Шаги для создания функции:

1. Войдите в ваш [Supabase Dashboard](https://supabase.com/dashboard)
2. Выберите ваш проект
3. Перейдите в раздел **SQL Editor** (находится в левой боковой панели)
4. Создайте новый запрос или используйте существующий терминал
5. Выполните следующий SQL-код:

> **⚠️ ВАЖНО:** Обратите внимание на использование **двух знаков доллара** `$$` (а не одного `$`) в начале и конце тела функции. Это обязательный синтаксис PostgreSQL для "dollar quoting".

```sql
CREATE OR REPLACE FUNCTION get_user_tables()
RETURNS TABLE (table_name text) 
LANGUAGE plpgsql
AS $$
BEGIN
  RETURN QUERY
  SELECT t.table_name::text
  FROM information_schema.tables t
  WHERE t.table_schema = 'public'
    AND t.table_type = 'BASE TABLE'
    AND NOT t.table_name LIKE 'pg_%'
    AND NOT t.table_name LIKE 'sql_%'
  ORDER BY t.table_name;
END;
$$;
```

**Пояснение синтаксиса:**
- `AS $$` - открывает тело функции (ДВА знака доллара!)
- `$$;` - закрывает тело функции (ДВА знака доллара!)
- Если использовать один знак `$`, PostgreSQL выдаст синтаксическую ошибку

### Назначение функции:

- Функция `get_user_tables()` безопасно возвращает список таблиц из схемы `public`
- Она исключает системные таблицы (те, что начинаются с `pg_` или `sql_`)
- Используется приложением для получения списка таблиц вместо прямого обращения к `information_schema`
- Обеспечивает безопасность, так как не требует предоставления сервисного ключа клиенту

### Проверка работы функции:

После создания функции вы можете проверить её работу, выполнив:

```sql
SELECT * FROM get_user_tables();
```

Если функция возвращает список ваших таблиц, то всё настроено правильно.

## Дополнительная информация

После создания этой функции приложение сможет использовать безопасный метод получения списка таблиц через RPC вызов, что является рекомендуемым подходом для production-окружений.